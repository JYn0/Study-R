# R

08.13



R 온라인 교재 -> <https://thebook.io/006723/>

통계를 기반으로한 데이터 분석

 R은 통계, 기계 학습, 금융, 생물정보학, 그래픽스에 이르는 다양한 통계 패키지를 갖추고 있으며 이 모든 것이 무료로 제공된다. 이러한 다양한 패키지는 CRAN(<http://cran.r-project.org/web/views/>)을 통해 한곳에서 살펴볼 수 있다.



R ->  <http://www.r-project.org/>

RStudio -> <https://www.rstudio.com/>

[RStudio 1.2.1335 - Windows 7+ (64-bit)]

new project - new directory - new project

 '+'-> Rscript 

'source' -> 전체를 메모리에 올려서 실행

'run' -> line 단위로 실행



* 패키지 다운받기(console)

```R
install.packages("randomForest")
# => C:\Program Files\R\R-3.6.1\library 다운로드 위치

library(randomForest);
.2 <- 100;
a <- 100;
b <- 200;
c <- a+b;
print(c)
```













---------------



### 데이터 프레임

데이터 프레임Data Frame은 처리할 데이터를 마치 엑셀의 스프레드시트와 같이 표 형태로 정리한 모습을 하고 있다. 데이터 프레임의 각 열에는 관측값의 이름이 저장되고, 각 행에는 매 관측 단위마다 실제 얻어진 값이 저장된다.  데이터 프레임은 R에서 가장 중요한 데이터 타입이며, 많은 R 함수에서 인자로 데이터 프레임을 받는다.



```R
df1 <- data.frame(x=c(1:5),y=c(5:9),z=c(10:14))
print(df1)
  x y  z
1 1 5 10
2 2 6 11
3 3 7 12
4 4 8 13
5 5 9 14


df1 <- data.frame(x=c(1:5),y=c(5:9),z=c(10:14))
# column
print(df1$x)
# row
print(df1[1,])
# xcolum 3
print(df1$x[3])
print(df1[3,1])
print(df1["x"])
print(df1[,2])
[1] 1 2 3 4 5
  x y  z
1 1 5 10
[1] 3
[1] 3
  x
1 1
2 2
3 3
4 4
5 5
[1] 5 6 7 8 9

# cutting 2,2~5,3
df2 <- df1[c(2:5),c(2:3)]
print(df2)
  y  z
2 6 11
3 7 12
4 8 13
5 9 14



each1 <- c(mean(df1$lee),mean(df1$kim),mean(df1$han),
          mean(df1$jun),mean(df1$goo))
print(each1)
print(mean(each1))

each2 <- c(sum(df1[1,]),sum(df1[2,]),sum(df1[3,]),
           sum(df1[1,]),sum(df1[1,]))
print(each2)
[1] 90.25 89.75 91.25 90.75 90.50
[1] 90.5
[1] 460 485 436 460 460

df1 <- data.frame(
  a=(1:4),
  b=(5:8),
  c=(9:12),
  d=c("A","B","A","B")
)
rownames(df1) <- c("aa","bb","cc","dd")
print(df1)
df2 <- df1[,-4]
print(df2)

   a b  c d
aa 1 5  9 A
bb 2 6 10 B
cc 3 7 11 A
dd 4 8 12 B
   a b  c
aa 1 5  9
bb 2 6 10
cc 3 7 11
dd 4 8 12


df2 <- df1[,c(-3,-4)]
print(df2)
   a b
aa 1 5
bb 2 6
cc 3 7
dd 4 8

print(df1[1,3])
print(df2$a)
print(mean(df2$a))
print(df2[1,])
print(mean(as.numeric(df2[1,])))
[1] 9
[1] 1 2 3 4
[1] 2.5
   a b c
aa 1 5 9
[1] 5

# 1행1열부터 4행3열까지 짜르기
df3 <- df1[c(1:4),c(1:3)]
#type 뭔지
print(class(df3))

# b행
df3 <- df1[,"b"]
print(df3)
[1] 5 6 7 8
# b행, a행
df3 <- df1[,c("b","a")]
print(df3)
   b a
aa 5 1
bb 6 2
cc 7 3
dd 8 4



data <- data.frame(
  "lee"=c(90,86,81,95),
  "kim"=c(91,85,82,94),
  "hong"=c(92,84,83,93),
  "kang"=c(93,83,84,92),
  "han"=c(94,82,85,91),
  "goo"=c(95,81,86,90)
)

a1 <- c(sum(data$lee),sum(data$kim),sum(data$hong),
        sum(data$kang),sum(data$han),sum(data$goo))
a2 <- c(mean(data$lee),mean(data$kim),mean(data$hong),
        mean(data$kang),mean(data$han),mean(data$goo))

b1 <- c(sum(as.numeric(data[1,c(1:6)])),sum(as.numeric(data[2,c(1:6)])),
        sum(as.numeric(data[3,c(1:6)])),sum(as.numeric(data[4,c(1:6)])),
        sum(as.numeric(data[5,c(1:6)])),sum(as.numeric(data[6,c(1:6)])))
b2 <- c(mean(as.numeric(data[1,])),mean(as.numeric(data[2,])),
        mean(as.numeric(data[3,])),mean(as.numeric(data[4,])),
        mean(as.numeric(data[5,])),mean(as.numeric(data[6,])))

print(data)
print(a1)
print(a2)
print(b1)
print(b2)

data[5,] <- a1
data[6,] <- a2
data$dsum <- b1
data$davg <- b2

print(data)
------------------------------------
df <- data.frame(lee=c((data$lee),(a1[1]),(a2[1])),
                 kim=c((data$kim),(a1[2]),(a2[2])),
                 hong=c((data$hong),(a1[3]),(a2[3])),
                 kang=c((data$kang),(a1[4]),(a2[4])),
                 han=c((data$han),(a1[5]),(a2[5])),
                 goo=c((data$goo),(a1[6]),(a2[6])),
                 avg=c(b2,NA,NA),
                 sum=c(b1,NA,NA)
                 )
print(df)
```





## R 프로그래밍

* 데이터 다루는 방법이 다름
* NA 조심(NULL은 그냥 pass됨)
* 객체의 불변성



```R
data2 <- data[data$lee >= 90,]
print(data2)
  lee kim hong kang han goo dsum davg
1  90  91   92   93  94  95  555 92.5
4  95  94   93   92  91  90  555 92.5
5 352 352  352  352 352 352   NA   NA


NA제거하고 사용
d1 <- c(10,20,30,40,NA)
print(sum(d1,na.rm = TRUE))
[1] 100

d1 <- c(10,20,10,20,NA)
print(mean(d1,na.rm = TRUE))
[1] 15


f1 <- function(){
  return (100);
}
result <- f1()
print(result) # 100

f1 <- function(a){
  return (100+a);
}
result <- f1(200.11)
print(result) # 300.11


가변길이함수
f1 <- function(...){
  args <- list(...)
  for(i in args){
    print(i)
  }
}
f1(1,2,3,4,5,6,10)
[1] 1
[1] 2
[1] 3
[1] 4
[1] 5
[1] 6
[1] 10

f1 <- function(...){
  sum <- 0
  for(i in (...)){
    if(i %% 2 == 0){
      sum = sum+i
    }
  }
  return (sum)
}

result <- f1(c(1:100))
print(result) # 2550 짝수만 더하기
```

스코프

```R
n <- 100
f1 <- function(){
  n <- 1
  return (n)
}
print(f1()) # 1

rm(list=ls())
print(list)
# -> global environment 모두 삭제
```



자바가 R의 함수를 호출함, 리턴값을 자바에게 전달

로그파일이나 DB나 hive로 데이터를 가져옴

R : 통계패키지를 쓰기